import{r as l,u as v,j as e}from"./index-YnYz-TJH.js";import{B as f}from"./Button-DF_Pa0Zh.js";import{N as k,s as T}from"./mainFunction-D2f_-6Zq.js";import S from"./Loader-D63eBvUQ.js";const L=()=>{const[d,p]=l.useState(!0),[u,m]=l.useState(!1),[g,o]=l.useState(""),[j,h]=l.useState(!1),[t,n]=l.useState({}),[w,x]=l.useState(),N=v(),b=s=>{const r={};return s.name?s.name.length<3?r.name="Name must be at least 3 characters":s.name.length>20&&(r.name="Name cannot exceed more than 20 characters"):r.name="Name is required",s.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(s.email)||(r.email="Invalid email address"):r.email="Email is required",s.password?/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{6,20}$/.test(s.password)?s.password.length<6?r.password="Password must be at least 6 characters":s.password.length>20&&(r.password="Password cannot exceed more than 20 characters"):r.password="Password is weak":r.password="Password is required",s.password!==s.confirmPassword?r.confirmPassword="Passwords do not match":s.confirmPassword||(r.confirmPassword="Confirm Password is required"),r},c=s=>{const{name:r,value:a}=s.target;x(i=>({...i,[r]:a})),n(i=>({...i,[r]:""}))};l.useEffect(()=>{d&&x({name:"",email:"",password:"",confirmPassword:""}),u&&x({email:"",password:""})},[d,u]);const y=async s=>{s.preventDefault();const r=b(w);if(n(r),Object.keys(r).length>0){console.log(r);return}h(!0);try{const a=await fetch("https://server-final.up.railway.app/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),i=await a.json();a.ok?(i.code===201?p(!1):m(!1),i.code===201?o(i.message):o(""),setTimeout(()=>{o(""),m(!0)},3e3)):(console.log("Registration error:",i),o(i.message),setTimeout(()=>{o("")},3e3))}catch(a){console.error("Error:",a),o(a.message),setTimeout(()=>{o("")},3e3)}h(!1)},C=async s=>{h(!0),s.preventDefault();try{const r=await fetch("https://server-final.up.railway.app/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),a=await r.json();r.ok?(console.log("Login successful:",a),a.code===200&&(o(a.message),setTimeout(()=>{o(""),N("/admin")},3e3),T("token",a.token,1),p(!1),m(!1))):(a.code===400&&(o(a.message),setTimeout(()=>{o("")},3e3)),console.log("Login error:",a))}catch(r){console.error("Error:",r)}h(!1)},P=l.useMemo(()=>e.jsx(k,{text:g,func:()=>o("")}),[g]);return e.jsx("main",{className:"homepage",children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{children:"QUIZZIE"}),e.jsxs("div",{className:"btnContainer",children:[e.jsx(f,{activeClass:d?"active":"",btnType:"left",text:"sign up",func:()=>{p(!0),m(!1)}}),e.jsx(f,{activeClass:u?"active":"",text:"login",btnType:"right",func:()=>{m(!0),p(!1)}})]}),e.jsxs("div",{className:"formContainer",children:[d&&e.jsx("div",{className:"signUpForm",children:e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,autoFocus:!0,onChange:c}),t.name&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,name:""})),children:t.name})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",required:!0,onChange:c}),t.email&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,email:""})),children:t.email})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:t.password?"text":"password",id:"password",name:"password",required:!0,onChange:c}),t.password&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,password:""})),children:t.password})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx("input",{type:t.confirmPassword?"text":"password",id:"confirmPassword",name:"confirmPassword",required:!0,onChange:c}),t.confirmPassword&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,confirmPassword:""})),children:t.confirmPassword})]}),e.jsx(f,{type:"submit",text:"sign up",activeClass:"btn",btnType:"btn"})]})}),u&&e.jsx("div",{className:"loginForm",children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",required:!0,name:"email",onChange:c}),t.email&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,email:""})),children:t.email})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",required:!0,onChange:c}),t.password&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,password:""})),children:t.password})]}),e.jsx(f,{type:"submit",text:"login",activeClass:"btn",btnType:"btn"})]})})]}),g.length>0&&P,j&&e.jsx(S,{})]})})};export{L as default};
