import{r as l,u as v,j as e}from"./index-BsGi0Z90.js";import{B as f}from"./Button-BXglfU5k.js";import{N as k,s as T}from"./mainFunction-Dnha3NpN.js";import S from"./Loader-DxiaRQZX.js";const L=()=>{const[d,p]=l.useState(!0),[u,m]=l.useState(!1),[w,o]=l.useState(""),[j,h]=l.useState(!1),[t,n]=l.useState({}),[g,x]=l.useState(),N=v(),b=s=>{const a={};return s.name?s.name.length<3?a.name="Name must be at least 3 characters":s.name.length>20&&(a.name="Name cannot exceed more than 20 characters"):a.name="Name is required",s.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(s.email)||(a.email="Invalid email address"):a.email="Email is required",s.password?/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{6,20}$/.test(s.password)?s.password.length<6?a.password="Password must be at least 6 characters":s.password.length>20&&(a.password="Password cannot exceed more than 20 characters"):(a.password="Password is weak",alert("use at least 1 uppercase, 1 lowercase, 1 number and 1 special character")):a.password="Password is required",s.password!==s.confirmPassword?a.confirmPassword="Passwords do not match":s.confirmPassword||(a.confirmPassword="Confirm Password is required"),a},c=s=>{const{name:a,value:r}=s.target;x(i=>({...i,[a]:r})),n(i=>({...i,[a]:""}))};l.useEffect(()=>{d&&x({name:"",email:"",password:"",confirmPassword:""}),u&&x({email:"",password:""})},[d,u]);const y=async s=>{s.preventDefault();const a=b(g);if(n(a),Object.keys(a).length>0){console.log(a);return}h(!0);try{const r=await fetch("https://server-final.up.railway.app/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),i=await r.json();r.ok?(i.code===201?p(!1):m(!1),i.code===201?o(i.message):o(""),setTimeout(()=>{o(""),m(!0)},3e3)):(console.log("Registration error:",i),o(i.message),setTimeout(()=>{o("")},3e3))}catch(r){console.error("Error:",r),o(r.message),setTimeout(()=>{o("")},3e3)}h(!1)},C=async s=>{h(!0),s.preventDefault();try{const a=await fetch("https://server-final.up.railway.app/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),r=await a.json();a.ok?(console.log("Login successful:",r),r.code===200&&(o(r.message),setTimeout(()=>{o(""),N("/admin")},3e3),T("token",r.token,1),p(!1),m(!1))):(r.code===400&&(o(r.message),setTimeout(()=>{o("")},3e3)),console.log("Login error:",r))}catch(a){console.error("Error:",a)}h(!1)},P=l.useMemo(()=>e.jsx(k,{text:w,func:()=>o("")}),[w]);return e.jsx("main",{className:"homepage",children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{children:"QUIZZIE"}),e.jsxs("div",{className:"btnContainer",children:[e.jsx(f,{activeClass:d?"active":"",btnType:"left",text:"sign up",func:()=>{p(!0),m(!1)}}),e.jsx(f,{activeClass:u?"active":"",text:"login",btnType:"right",func:()=>{m(!0),p(!1)}})]}),e.jsxs("div",{className:"formContainer",children:[d&&e.jsx("div",{className:"signUpForm",children:e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,autoFocus:!0,onChange:c}),t.name&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,name:""})),children:t.name})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",required:!0,onChange:c}),t.email&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,email:""})),children:t.email})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:t.password?"text":"password",id:"password",name:"password",required:!0,onChange:c}),t.password&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,password:""})),children:t.password})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx("input",{type:t.confirmPassword?"text":"password",id:"confirmPassword",name:"confirmPassword",required:!0,onChange:c}),t.confirmPassword&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,confirmPassword:""})),children:t.confirmPassword})]}),e.jsx(f,{type:"submit",text:"sign up",activeClass:"btn",btnType:"btn"})]})}),u&&e.jsx("div",{className:"loginForm",children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",required:!0,name:"email",onChange:c}),t.email&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,email:""})),children:t.email})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",name:"password",required:!0,onChange:c}),t.password&&e.jsx("p",{className:"error",onClick:()=>n(s=>({...s,password:""})),children:t.password})]}),e.jsx(f,{type:"submit",text:"login",activeClass:"btn",btnType:"btn"})]})})]}),w.length>0&&P,j&&e.jsx(S,{})]})})};export{L as default};
